# Example audit config file
#
# It may be located in the user home (`~/.cargo/audit.toml`) or in the project
# root (`.cargo/audit.toml`).
#
# All of the options which can be passed via CLI arguments can also be
# permanently specified in this file.

[advisories]
# advisory IDs to ignore e.g. ["RUSTSEC-2019-0001", ...]
ignore = [
    # Crate:     rsa
    # Version:   0.9.8
    # Title:     Marvin Attack: potential key recovery through timing sidechannels
    # Date:      2023-11-22
    # ID:        RUSTSEC-2023-0071
    # URL:       https://rustsec.org/advisories/RUSTSEC-2023-0071
    # Severity:  5.9 (medium)
    # Solution:  No fixed upgrade is available!
    #
    # Ignoring because the crate is only used in tests to generate a keypair for the mock server.
    "RUSTSEC-2023-0071",

    # Crate:     tokio-tar
    # Version:   0.3.1
    # Title:     `tokio-tar` parses PAX extended headers incorrectly, allows file smuggling
    # Date:      2025-10-21
    # ID:        RUSTSEC-2025-0111
    # URL:       https://rustsec.org/advisories/RUSTSEC-2025-0111
    # Solution:  No fixed upgrade is available!
    #
    # Ignoring because:
    # - tokio-tar is a dev dependency via testcontainers (used only in E2E tests)
    # - We control all Docker images used in tests (no untrusted tar files)
    # - Migration to astral-tokio-tar tracked for future release
    "RUSTSEC-2025-0111",

    # Crate:     protobuf
    # Version:   2.28.0
    # Title:     Crash due to uncontrolled recursion in protobuf crate
    # Date:      2024-12-12
    # ID:        RUSTSEC-2024-0437
    # URL:       https://rustsec.org/advisories/RUSTSEC-2024-0437
    # Solution:  Upgrade to >=3.7.2 (requires prometheus >=0.14)
    #
    # Ignoring because prometheus 0.13 is used exclusively for metrics collection
    # and exposition (Prometheus text format). We never parse protobuf-encoded input
    # from untrusted sources, so the vulnerable recursion path is not reachable.
    # Tracked for upgrade when a prometheus release drops the protobuf 2.x dependency.
    "RUSTSEC-2024-0437",
]
# informational_warnings = ["unmaintained"] # warn for categories of informational advisories
# severity_threshold = "low" # CVSS severity ("none", "low", "medium", "high", "critical")

# Advisory Database Configuration
# [database]
# path = "~/.cargo/advisory-db" # Path where advisory git repo will be cloned
# url = "https://github.com/RustSec/advisory-db.git" # URL to git repo
# fetch = true # Perform a `git fetch` before auditing (default: true)
# stale = false # Allow stale advisory DB (i.e. no commits for 90 days, default: false)

# Output Configuration
# [output]
# deny = ["unmaintained"] # exit on error if unmaintained dependencies are found
# format = "terminal" # "terminal" (human readable report) or "json"
# quiet = false # Only print information on error
# show_tree = true # Show inverse dependency trees along with advisories (default: true)

# Target Configuration
# [target]
# arch = ["x86_64"] # Ignore advisories for CPU architectures other than these
# os = ["linux", "windows"] # Ignore advisories for operating systems other than these

[yanked]
enabled = true      # Warn for yanked crates in Cargo.lock (default: true)
update_index = true # Auto-update the crates.io index (default: true)
